generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Order {
  id                    String        @id @default(cuid())
  modalityId            String
  tickets               Int
  status                String        @default("PENDING")
  termsAccepted         Boolean       @default(false)
  totalAmount           Int?
  ticketsAmount         Int?
  extrasAmount          Int?
  createdAt             DateTime      @default(now())
  updatedAt             DateTime      @updatedAt
  stripeSessionId       String?       @unique
  stripePaymentIntentId String?
  participants          Participant[]
}

model Participant {
  id             String             @id @default(cuid())
  orderId        String
  fullName       String
  cpf            String
  birthDate      String
  phone          String
  email          String
  city           String?
  state          String?
  tshirtSize     String
  emergencyName  String?
  emergencyPhone String?
  healthInfo     String?
  order          Order              @relation(fields: [orderId], references: [id])
  extras         ParticipantExtra[]
}

model ParticipantExtra {
  id            String      @id @default(cuid())
  participantId String
  type          String
  size          String?
  quantity      Int
  participant   Participant @relation(fields: [participantId], references: [id])
}
